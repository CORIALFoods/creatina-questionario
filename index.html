<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>CORIAL â€” QuestionÃ¡rio Creatina Balance</title>
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;min-height:100%;overflow-x:hidden}
html{font-size:16px;-webkit-text-size-adjust:100%}
body{font-family:'Bricolage Grotesque',sans-serif;background:#FEF9E3;color:#791812;line-height:1.5;padding:20px;display:flex;justify-content:center;align-items:flex-start}
:root{--berry:#791812;--eggshell:#FEF9E3;--begonia:#FF7276;--bistre:#342119;--r:12px}
.quiz-container{max-width:560px;width:100%;margin:0 auto;padding-top:20px;padding-bottom:40px}
.quiz-content{padding:40px}
@media(max-width:480px){.quiz-content{padding:24px}}
.progress-container{margin-bottom:32px}
.progress-bar{height:6px;background:rgba(121,24,18,.12);border-radius:3px;overflow:hidden}
.progress-fill{height:100%;background:var(--berry);border-radius:3px;transition:width .4s;width:0}
.progress-text{font-size:12px;font-weight:600;margin-top:10px;opacity:.6;text-transform:uppercase}
.screen{display:none;animation:fadeIn .4s}
.screen.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.welcome-icon{font-size:56px;margin-bottom:24px}
.welcome-title{font-size:28px;font-weight:700;margin-bottom:12px;line-height:1.2}
.welcome-description{font-size:15px;color:var(--bistre);margin-bottom:12px;line-height:1.6;opacity:.9}
.welcome-cta{font-size:15px;font-weight:500;margin-bottom:28px}
.welcome-badges{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:32px}
.badge{font-size:12px;font-weight:600;text-transform:uppercase;padding:10px 16px;border-radius:25px;background:rgba(121,24,18,.08)}
.badge.highlight{background:var(--begonia);color:#fff}
.question-title{font-size:22px;font-weight:600;margin-bottom:24px;line-height:1.3}
.question-subtitle{font-size:14px;color:var(--bistre);opacity:.7;margin-top:-16px;margin-bottom:24px}
.choices-container{display:flex;flex-direction:column;gap:12px;margin-bottom:24px}
.choice-option{display:flex;align-items:center;gap:14px;padding:16px 20px;border:2px solid rgba(121,24,18,.15);border-radius:var(--r);cursor:pointer;transition:all .2s;background:#fff}
.choice-option:hover{border-color:var(--berry)}
.choice-option.selected{border-color:var(--berry);background:rgba(121,24,18,.06)}
.choice-icon{font-size:24px;flex-shrink:0}
.choice-content{flex:1;min-width:0}
.choice-label{font-size:15px;font-weight:600;margin-bottom:2px}
.choice-description{font-size:13px;color:var(--bistre);opacity:.7}
.choice-check{width:24px;height:24px;border:2px solid rgba(121,24,18,.25);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.choice-option.selected .choice-check{background:var(--berry);border-color:var(--berry)}
.choice-option.selected .choice-check::after{content:'âœ“';color:#fff;font-weight:700;font-size:14px}
.choice-option.multiple .choice-check{border-radius:6px}
.slider-container{margin-bottom:24px}
.slider-labels{display:flex;justify-content:space-between;margin-bottom:16px}
.slider-label{font-size:13px;color:var(--bistre);opacity:.7;max-width:45%}
.slider-label:last-child{text-align:right}
input[type=range]{-webkit-appearance:none;width:100%;height:8px;background:rgba(121,24,18,.12);border-radius:4px;cursor:pointer}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:32px;height:32px;background:var(--berry);border-radius:50%;cursor:pointer}
.slider-scale{display:flex;justify-content:space-between;margin-top:12px}
.scale-point{font-size:13px;font-weight:600;opacity:.4;cursor:pointer}
.scale-point.active{opacity:1}
.emoji-feedback{text-align:center;font-size:40px;margin-top:20px}
.text-input{width:100%;padding:18px 20px;font-family:'Bricolage Grotesque',sans-serif;font-size:16px;border:2px solid rgba(121,24,18,.2);border-radius:var(--r);background:#fff;margin-bottom:20px;resize:vertical;min-height:100px}
.text-input:focus{outline:0;border-color:var(--berry)}
.btn{font-family:'Bricolage Grotesque',sans-serif;font-size:16px;font-weight:600;padding:18px 32px;border:none;border-radius:var(--r);cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:8px;width:100%;text-decoration:none;transition:all .2s}
.btn-primary{background:var(--berry);color:var(--eggshell)}
.btn-primary:hover{background:var(--bistre);transform:translateY(-2px)}
.btn-primary:disabled{background:rgba(121,24,18,.3);cursor:not-allowed;transform:none}
.btn-back{background:transparent;color:var(--berry);border:2px solid rgba(121,24,18,.2);flex:0 0 auto;width:auto;padding:18px 24px}
.btn-back:hover{border-color:var(--berry)}
.nav-buttons{display:flex;gap:12px;margin-top:32px}
.nav-buttons .btn-primary{flex:1}
.skip-link{display:block;text-align:center;margin-top:14px;font-size:13px;color:var(--bistre);opacity:.5;cursor:pointer;text-decoration:underline;background:none;border:none;font-family:inherit}
.skip-link:hover{opacity:.8}
.transition-screen{text-align:center;padding:20px 0}
.transition-icon{font-size:56px;margin-bottom:24px}
.transition-title{font-size:28px;font-weight:700;margin-bottom:12px;line-height:1.2}
.transition-subtitle{font-size:15px;color:var(--bistre);opacity:.85;margin-bottom:28px;line-height:1.5}
.comparison-row{display:flex;gap:12px;margin-bottom:24px}
.comparison-card{flex:1;background:#fff;border:2px solid rgba(121,24,18,.15);border-radius:var(--r);padding:20px 12px;text-align:center;cursor:pointer;transition:all .2s}
.comparison-card:hover{border-color:var(--berry);transform:translateY(-2px)}
.comparison-card.selected{border-color:var(--berry);background:rgba(121,24,18,.06)}
.comparison-emoji{font-size:36px;margin-bottom:8px}
.comparison-label{font-size:13px;font-weight:600;line-height:1.3}
.flavor-card{display:flex;align-items:center;gap:14px;padding:18px 20px;border:2px solid rgba(121,24,18,.15);border-radius:var(--r);cursor:pointer;transition:all .2s;background:#fff;margin-bottom:12px}
.flavor-card:hover{border-color:var(--berry);transform:translateY(-2px)}
.flavor-card.selected{border-color:var(--berry);background:rgba(121,24,18,.06)}
.flavor-icon{font-size:28px;width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:rgba(121,24,18,.06);border-radius:var(--r);flex-shrink:0}
.info-card{background:#fff;border:2px solid rgba(121,24,18,.1);border-radius:var(--r);padding:24px;margin-bottom:24px}
.info-card-title{font-size:15px;font-weight:700;margin-bottom:8px;display:flex;align-items:center;gap:8px}
.creatine-box{background:var(--berry);border-radius:var(--r);padding:28px;margin-bottom:24px;color:var(--eggshell);position:relative;overflow:hidden}
.creatine-box::after{content:'âš¡';position:absolute;right:16px;top:14px;font-size:40px;opacity:.15}
.creatine-box h3{font-size:20px;font-weight:700;margin-bottom:10px;position:relative}
.creatine-box>p{font-size:14px;line-height:1.6;opacity:.85;position:relative}
.creatine-list{list-style:none;margin-top:16px;display:flex;flex-direction:column;gap:10px;position:relative}
.creatine-list li{font-size:14px;display:flex;align-items:center;gap:10px}
.creatine-list li::before{content:'âœ“';background:rgba(254,249,227,.18);width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0}
.nt{width:100%;border-collapse:collapse;font-size:13px;margin-top:10px}
.nt th{text-align:left;padding:8px 10px;background:var(--berry);color:var(--eggshell);font-weight:600;font-size:11px;letter-spacing:.4px}
.nt th:first-child{border-radius:8px 0 0 0}
.nt th:last-child{border-radius:0 8px 0 0;text-align:center}
.nt td{padding:7px 10px;border-bottom:1px solid rgba(121,24,18,.08)}
.nt td:last-child{text-align:center;font-weight:600}
.nt .sub td:first-child{padding-left:22px;font-size:12px;color:var(--bistre);opacity:.7}
.nt tr:last-child td{border-bottom:none}
.ingredients-box{font-size:12px;color:var(--bistre);opacity:.7;line-height:1.6;padding:10px 12px;background:rgba(121,24,18,.03);border-radius:8px;margin-top:10px}
.allergen-row{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
.allergen-tag{font-size:11px;background:rgba(121,24,18,.08);padding:4px 10px;border-radius:20px;font-weight:500}
.tabs{display:flex;gap:8px;margin-bottom:16px}
.tab-btn{flex:1;padding:12px 8px;border:2px solid rgba(121,24,18,.15);background:#fff;border-radius:var(--r);font-family:inherit;font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;text-align:center}
.tab-btn.active{border-color:var(--berry);background:var(--berry);color:var(--eggshell)}
.science-ref{font-size:11px;color:var(--bistre);opacity:.5;margin-top:6px;font-style:italic}
.footer{text-align:center;margin-top:32px;padding-top:24px;border-top:1px solid rgba(121,24,18,.1)}
.footer-logo{font-size:24px;margin-bottom:8px}
.footer-text{font-size:13px;color:var(--bistre);opacity:.6}
.gdpr-note{font-size:12px;color:var(--bistre);opacity:.5;margin-top:24px;padding-top:16px;border-top:1px solid rgba(121,24,18,.1);line-height:1.5;text-align:center}
@media(max-width:480px){
.welcome-title,.transition-title{font-size:24px}
.question-title{font-size:20px}
.nav-buttons{flex-direction:column}
.btn-back{width:100%;order:2}
.comparison-row{flex-direction:column}
}
</style>
</head>
<body>
<div class="quiz-container"><div class="quiz-content">
<div class="progress-container" id="progressContainer" style="display:none">
<div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
<div class="progress-text" id="progressText"></div>
</div>
<div id="screenContainer"></div>
<div class="footer"><div class="footer-logo">ğŸŒ¿</div><p class="footer-text">Â© 2026 CORIAL Foods Â· corialfoods.com</p></div>
</div></div>
<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASIN CONFIG â€” substitui pelo teu endpoint
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var BASIN_URL='https://usebasin.com/f/SEU_ID_AQUI';

var BASIN_URL='https://usebasin.com/f/b8a9a96e59cf';

var FLAVORS={
coco:{id:'coco',name:'Coco & Chocolate Branco',emoji:'ğŸ¥¥',short:'Coco & Choc. Branco',
ingredients:'TÃ¢maras, amÃªndoa, proteÃ­na de trigo, aveia, creatina monohidratada, chocolate branco (aÃ§Ãºcar, manteiga de cacau, leite inteiro em pÃ³, lactose, leite magro em pÃ³, emulsionante: lecitinas, aroma natural de baunilha) (7%), coco (coco ralado, conservante: metabissulfito de sÃ³dio) (3,5%), Ã³leo de coco (3%).',
allergens:['GlÃºten','Leite','Frutos de casca rija','Sulfitos'],traces:['Amendoim'],
nutrition:[['Energia','1678 kJ / 401 kcal'],['LÃ­pidos','17 g'],['&nbsp;&nbsp;saturados','7,3 g'],['Hidratos de carbono','44 g'],['&nbsp;&nbsp;aÃ§Ãºcares','26 g'],['Fibra','5,5 g'],['ProteÃ­nas','15 g'],['Sal','0,02 g']]},
frutos:{id:'frutos',name:'Frutos Vermelhos & Chocolate Negro',emoji:'ğŸ«',short:'Frutos Verm. & Choc. Negro',
ingredients:'TÃ¢maras, amÃªndoa, proteÃ­na de trigo, aveia, creatina monohidratada, chocolate negro (7%) [Pasta de cacau, edulcorante (maltitol), cacau magro em pÃ³, emulsionante (lecitina de soja), aroma natural de baunilha], aromas naturais de framboesa e cereja (0,6%).',
allergens:['GlÃºten','Soja','Frutos de casca rija'],traces:['Amendoim','Leite'],
nutrition:[['Energia','1561 kJ / 373 kcal'],['LÃ­pidos','13 g'],['&nbsp;&nbsp;saturados','2,4 g'],['Hidratos de carbono','45 g'],['&nbsp;&nbsp;aÃ§Ãºcares','23 g'],['&nbsp;&nbsp;poliÃ³is','3,2 g'],['Fibra','5,4 g'],['ProteÃ­nas','17 g'],['Sal','0,01 g']]}
};

var answers={};
var firstFlavor=null;
var currentStep=0;
var infoTab='coco';

function sf(){return firstFlavor==='coco'?'frutos':'coco';}

function tasteSteps(fid,num){
var f=FLAVORS[fid];
var b='Prova '+num+'/2 â€” '+f.emoji+' '+f.short;
var steps=[
{id:fid+'_aspeto',badge:b,title:'Como avalias o aspeto visual da barra?',sub:num===1?'Prova a barra com calma. ComeÃ§a por observÃ¡-la.':'Agora a segunda barra. Bebe um golo de Ã¡gua antes.',type:'slider',lo:'Nada apelativo',hi:'Muito apelativo'},
{id:fid+'_aroma',badge:b,title:'Como avalias o aroma?',type:'choice',opts:[{v:'AgradÃ¡vel',icon:'ğŸ‘ƒ',label:'AgradÃ¡vel'},{v:'Neutro',icon:'ğŸ˜',label:'Neutro'},{v:'DesagradÃ¡vel',icon:'ğŸ¤¢',label:'DesagradÃ¡vel'}]},
{id:fid+'_sabor',badge:b,title:'Como avalias o sabor geral?',sub:'Agora sim, prova!',type:'slider',lo:'NÃ£o gostei',hi:'Adorei'},
{id:fid+'_residual',badge:b,title:'Sentes algum sabor residual desagradÃ¡vel?',sub:'Por exemplo: amargo, metÃ¡lico, arenoso...',type:'choice',opts:[{v:'Sim',icon:'ğŸ˜¬',label:'Sim'},{v:'Ligeiro',icon:'ğŸ¤”',label:'Ligeiro'},{v:'NÃ£o',icon:'ğŸ˜Š',label:'NÃ£o'}]},
];
if(answers[fid+'_residual']==='Sim'||answers[fid+'_residual']==='Ligeiro'){
steps.push({id:fid+'_residualDesc',badge:b,title:'Descreve o sabor residual:',type:'text',ph:'Ex: amargo, metÃ¡lico, arenoso...'});
}
steps=steps.concat([
{id:fid+'_docura',badge:b,title:'Como avalias a doÃ§ura?',type:'choice',opts:[{v:'Pouco doce',icon:'ğŸ‹',label:'Pouco doce'},{v:'Equilibrado',icon:'ğŸ‘Œ',label:'Equilibrado'},{v:'Demasiado doce',icon:'ğŸ¯',label:'Demasiado doce'}]},
{id:fid+'_textura',badge:b,title:'Como avalias a textura?',type:'choice',opts:[{v:'Demasiado dura',icon:'ğŸª¨',label:'Demasiado dura'},{v:'Ideal',icon:'ğŸ‘Œ',label:'Ideal'},{v:'Demasiado mole',icon:'ğŸ« ',label:'Demasiado mole'},{v:'Arenosa',icon:'â³',label:'Arenosa'},{v:'Pegajosa',icon:'ğŸ¯',label:'Pegajosa'}]},
{id:fid+'_mastigar',badge:b,title:'Ã‰ fÃ¡cil de mastigar?',type:'slider',lo:'Muito difÃ­cil',hi:'Muito fÃ¡cil'},
{id:fid+'_compraria',badge:b,title:'Comprarias esta barra?',type:'choice',opts:[{v:'Sim, com certeza',icon:'ğŸ¤©',label:'Sim, com certeza'},{v:'Provavelmente sim',icon:'ğŸ™‚',label:'Provavelmente sim'},{v:'Talvez',icon:'ğŸ¤”',label:'Talvez'},{v:'Provavelmente nÃ£o',icon:'ğŸ˜•',label:'Provavelmente nÃ£o'},{v:'NÃ£o',icon:'âŒ',label:'NÃ£o'}]},
{id:fid+'_sugestoes',badge:b,title:'SugestÃµes de melhoria para esta barra?',sub:'Opcional â€” diz-nos o que mudarias.',type:'text',ph:'O que mudarias?',opt:true},
]);
return steps;
}

function buildSteps(){
var s=[];
s.push({id:'_welcome',type:'welcome'});
s.push({id:'exercicio',badge:'Sobre ti',title:'Praticas exercÃ­cio fÃ­sico regularmente?',type:'choice',opts:[{v:'Sim',icon:'âœ…',label:'Sim'},{v:'NÃ£o',icon:'âŒ',label:'NÃ£o'}]});
if(answers.exercicio==='Sim'){
s.push({id:'tipoExercicio',badge:'Sobre ti',title:'Que tipo de exercÃ­cio?',sub:'Podes seleccionar vÃ¡rias opÃ§Ãµes',type:'multi',opts:[{v:'GinÃ¡sio',icon:'ğŸ‹ï¸',label:'GinÃ¡sio / MusculaÃ§Ã£o'},{v:'Corrida / Cardio',icon:'ğŸƒ',label:'Corrida / Cardio'},{v:'Desporto coletivo',icon:'âš½',label:'Desporto coletivo'},{v:'Outro',icon:'ğŸ¤¸',label:'Outro'}]});
}
s.push({id:'suplementos',badge:'Sobre ti',title:'Consomes suplementos alimentares?',type:'choice',opts:[{v:'Sim, regularmente',icon:'âœ…',label:'Sim, regularmente'},{v:'Ocasionalmente',icon:'ğŸ”„',label:'Ocasionalmente'},{v:'NÃ£o',icon:'âŒ',label:'NÃ£o'}]});
s.push({id:'creatina',badge:'Sobre ti',title:'Tomas ou jÃ¡ tomaste creatina?',type:'choice',opts:[{v:'Tomo atualmente',icon:'ğŸ’ª',label:'Tomo atualmente'},{v:'JÃ¡ tomei',icon:'ğŸ”„',label:'JÃ¡ tomei'},{v:'Nunca tomei',icon:'ğŸ¤·',label:'Nunca tomei'}]});
s.push({id:'conheceCr',badge:'Sobre ti',title:'Conheces os benefÃ­cios da creatina?',type:'choice',opts:[{v:'Sim, conheÃ§o bem',icon:'ğŸ§ ',label:'Sim, conheÃ§o bem'},{v:'Tenho uma ideia geral',icon:'ğŸ’¡',label:'Tenho uma ideia geral'},{v:'NÃ£o conheÃ§o',icon:'â“',label:'NÃ£o conheÃ§o'}]});
s.push({id:'barras',badge:'Sobre ti',title:'Costumas consumir barras proteicas ou funcionais?',type:'choice',opts:[{v:'Sim, frequentemente',icon:'ğŸ«',label:'Sim, frequentemente'},{v:'Ã€s vezes',icon:'ğŸ”„',label:'Ã€s vezes'},{v:'Raramente / Nunca',icon:'âŒ',label:'Raramente / Nunca'}]});
s.push({id:'_transition',type:'transition',icon:'ğŸ«',title:'Vamos Ã  prova!',sub:'Agora vais provar duas barras. Escolhe com qual queres comeÃ§ar e avalia cada uma com calma.'});
s.push({id:'_choose',badge:'Prova',title:'Com qual queres comeÃ§ar?',sub:'Vais provar as duas. Escolhe a primeira!',type:'chooseFlavor'});
if(firstFlavor){
s=s.concat(tasteSteps(firstFlavor,1));
s.push({id:'_transition2',type:'transition',icon:'ğŸ”„',title:'Segunda barra!',sub:'Bebe um golo de Ã¡gua para limpar o palato. Quando estiveres pronto/a, avanÃ§a.'});
s=s.concat(tasteSteps(sf(),2));
}
s.push({id:'preferida',badge:'ComparaÃ§Ã£o',title:'Qual das duas barras preferes?',type:'compare'});
s.push({id:'prefMotivo',badge:'ComparaÃ§Ã£o',title:'PorquÃª essa preferÃªncia?',type:'text',ph:'O que te fez preferir essa?',opt:true});
s.push({id:'ocasiao',badge:'ComparaÃ§Ã£o',title:'Em que ocasiÃ£o consumirias?',sub:'Podes seleccionar vÃ¡rias opÃ§Ãµes',type:'multi',opts:[{v:'PrÃ©-treino',icon:'ğŸ‹ï¸',label:'PrÃ©-treino'},{v:'PÃ³s-treino',icon:'ğŸ’ª',label:'PÃ³s-treino'},{v:'Snack diÃ¡rio',icon:'â˜€ï¸',label:'Snack diÃ¡rio'},{v:'Lanche no trabalho',icon:'ğŸ’¼',label:'Lanche no trabalho'},{v:'SubstituiÃ§Ã£o de refeiÃ§Ã£o',icon:'ğŸ½ï¸',label:'SubstituiÃ§Ã£o de refeiÃ§Ã£o'}]});
s.push({id:'_info',type:'info'});
s.push({id:'expectativa',badge:'OpiniÃ£o final',title:'A informaÃ§Ã£o nutricional corresponde ao que esperavas?',type:'choice',opts:[{v:'Sim, como esperava',icon:'ğŸ‘Œ',label:'Sim, como esperava'},{v:'Melhor do que esperava',icon:'ğŸ¤©',label:'Melhor do que esperava'},{v:'Pior do que esperava',icon:'ğŸ˜•',label:'Pior do que esperava'}]});
s.push({id:'surpresaPos',badge:'OpiniÃ£o final',title:'Algo te surpreendeu positivamente?',type:'text',ph:'Ex: a quantidade de proteÃ­na, os ingredientes naturais...',opt:true});
s.push({id:'surpresaNeg',badge:'OpiniÃ£o final',title:'E negativamente?',type:'text',ph:'Ex: o teor de aÃ§Ãºcar, um ingrediente especÃ­fico...',opt:true});
s.push({id:'intencaoPos',badge:'OpiniÃ£o final',title:'Sabendo a composiÃ§Ã£o, a tua intenÃ§Ã£o de compra muda?',type:'choice',opts:[{v:'Aumenta muito',icon:'ğŸš€',label:'Aumenta muito'},{v:'Aumenta',icon:'ğŸ“ˆ',label:'Aumenta'},{v:'MantÃ©m-se',icon:'â¡ï¸',label:'MantÃ©m-se'},{v:'Diminui',icon:'ğŸ“‰',label:'Diminui'}]});
s.push({id:'praticidade',badge:'OpiniÃ£o final',title:'Uma barra com 3g de creatina Ã© uma forma prÃ¡tica de suplementaÃ§Ã£o?',type:'slider',lo:'Nada prÃ¡tica',hi:'Muito prÃ¡tica'});
s.push({id:'preco',badge:'OpiniÃ£o final',title:'Que preÃ§o considerarias justo por barra (35g)?',type:'choice',opts:[{v:'< 2â‚¬',icon:'ğŸ’°',label:'Menos de 2â‚¬'},{v:'2â‚¬ - 2,50â‚¬',icon:'ğŸ’°',label:'2â‚¬ â€” 2,50â‚¬'},{v:'2,50â‚¬ - 3â‚¬',icon:'ğŸ’°',label:'2,50â‚¬ â€” 3â‚¬'},{v:'3â‚¬ - 3,50â‚¬',icon:'ğŸ’°',label:'3â‚¬ â€” 3,50â‚¬'},{v:'> 3,50â‚¬',icon:'ğŸ’°',label:'Mais de 3,50â‚¬'}]});
s.push({id:'confianca',badge:'OpiniÃ£o final',title:'A lista de ingredientes transmite-te confianÃ§a?',type:'choice',opts:[{v:'Sim',icon:'âœ…',label:'Sim'},{v:'Parcialmente',icon:'ğŸ¤”',label:'Parcialmente'},{v:'NÃ£o',icon:'âŒ',label:'NÃ£o'}]});
s.push({id:'comentarioFinal',badge:'OpiniÃ£o final',title:'Tens algum comentÃ¡rio final?',type:'text',ph:'Algo que queiras partilhar connosco...',opt:true});
s.push({id:'_thanks',type:'thanks'});
return s;
}

function renderNutritionTable(fid){
var f=FLAVORS[fid];
var h='<table class="nt"><tr><th>POR 100g</th><th>VALOR</th></tr>';
f.nutrition.forEach(function(r){
var isSub=r[0].indexOf('&nbsp;')===0;
h+='<tr'+(isSub?' class="sub"':'')+'><td>'+r[0]+'</td><td>'+r[1]+'</td></tr>';
});
h+='</table>';
h+='<div class="ingredients-box"><strong>Ingredientes:</strong> '+f.ingredients;
h+='<div class="allergen-row">';
f.allergens.forEach(function(a){h+='<span class="allergen-tag">âš ï¸ '+a+'</span>';});
f.traces.forEach(function(a){h+='<span class="allergen-tag">ğŸ“Œ VestÃ­gios: '+a+'</span>';});
h+='</div></div>';
return h;
}

function render(){
var steps=buildSteps();
if(currentStep>=steps.length)currentStep=steps.length-1;
var step=steps[currentStep];
var total=steps.length;
var container=document.getElementById('screenContainer');
var progC=document.getElementById('progressContainer');
var showProg=step.type!=='welcome'&&step.type!=='transition'&&step.type!=='thanks';
progC.style.display=showProg?'block':'none';
if(showProg){
var countable=0;for(var i=0;i<total;i++){if(steps[i].type!=='welcome'&&steps[i].type!=='transition'&&steps[i].type!=='thanks')countable++;}
var cur=0;for(var i=0;i<=currentStep;i++){if(steps[i].type!=='welcome'&&steps[i].type!=='transition'&&steps[i].type!=='thanks')cur++;}
document.getElementById('progressFill').style.width=((cur/countable)*100)+'%';
document.getElementById('progressText').textContent='Pergunta '+cur+' de '+countable;
}
var h='<div class="screen active">';

if(step.type==='welcome'){
h+='<div class="welcome-icon">ğŸ«</div>';
h+='<h1 class="welcome-title">Prova as nossas novas barras Creatina Balance</h1>';
h+='<p class="welcome-description">Ajuda-nos a criar o produto perfeito. Vais provar dois sabores e dizer-nos o que achas â€” demora cerca de 5 minutos.</p>';
h+='<p class="welcome-cta">A tua opiniÃ£o Ã© essencial para desenvolvermos produtos que fazem sentido.</p>';
h+='<div class="welcome-badges"><span class="badge">â±ï¸ 5 minutos</span><span class="badge">ğŸ« 2 sabores</span><span class="badge highlight">ğŸ“Š A tua opiniÃ£o conta</span></div>';
h+='<button class="btn btn-primary" onclick="goNext()">ComeÃ§ar â†’</button>';
h+='</div>';container.innerHTML=h;return;
}

if(step.type==='transition'){
h+='<div class="transition-screen"><div class="transition-icon">'+step.icon+'</div>';
h+='<h2 class="transition-title">'+step.title+'</h2>';
h+='<p class="transition-subtitle">'+step.sub+'</p>';
h+='<button class="btn btn-primary" onclick="goNext()">Continuar â†’</button></div></div>';
container.innerHTML=h;return;
}

if(step.type==='thanks'){
h+='<div class="transition-screen"><div class="transition-icon" id="thanksIcon">â³</div>';
h+='<h2 class="transition-title" id="thanksTitle">A enviar...</h2>';
h+='<p class="transition-subtitle" id="thanksSub">Aguarda um momento.</p>';
h+='<p class="gdpr-note">ğŸ”’ As tuas respostas sÃ£o anÃ³nimas e utilizadas apenas para desenvolvimento de produto.</p>';
h+='</div></div>';
container.innerHTML=h;
submitToBasin();
return;
}

if(step.badge)h+='<div style="margin-bottom:24px"><span class="badge">'+step.badge+'</span></div>';
h+='<h2 class="question-title">'+step.title+'</h2>';
if(step.sub)h+='<p class="question-subtitle">'+step.sub+'</p>';

if(step.type==='choice'){
h+='<div class="choices-container">';
step.opts.forEach(function(o){
var sel=answers[step.id]===o.v?' selected':'';
h+='<div class="choice-option'+sel+'" onclick="selectSingle(\''+step.id+'\',\''+o.v.replace(/'/g,"\\'")+'\')">';
h+='<span class="choice-icon">'+o.icon+'</span>';
h+='<div class="choice-content"><div class="choice-label">'+o.label+'</div>'+(o.desc?'<div class="choice-description">'+o.desc+'</div>':'')+'</div>';
h+='<div class="choice-check"></div></div>';
});
h+='</div>';
}

if(step.type==='multi'){
h+='<div class="choices-container">';
var arr=answers[step.id]||[];
step.opts.forEach(function(o){
var sel=arr.indexOf(o.v)>-1?' selected':'';
h+='<div class="choice-option multiple'+sel+'" onclick="toggleMulti(\''+step.id+'\',\''+o.v.replace(/'/g,"\\'")+'\')">';
h+='<span class="choice-icon">'+o.icon+'</span>';
h+='<div class="choice-content"><div class="choice-label">'+o.label+'</div></div>';
h+='<div class="choice-check"></div></div>';
});
h+='</div>';
}

if(step.type==='slider'){
var val=answers[step.id]||3;
var emojis=['','ğŸ˜«','ğŸ˜•','ğŸ˜','ğŸ™‚','ğŸ˜„'];
h+='<div class="slider-container">';
h+='<div class="slider-labels"><span class="slider-label">'+step.lo+'</span><span class="slider-label">'+step.hi+'</span></div>';
h+='<input type="range" id="sliderInput" min="1" max="5" value="'+val+'" oninput="updateSlider(\''+step.id+'\')">';
h+='<div class="slider-scale">';
for(var i=1;i<=5;i++){h+='<span class="scale-point'+(i===val?' active':'')+'" onclick="setSlider(\''+step.id+'\','+i+')">'+i+'</span>';}
h+='</div>';
h+='<div class="emoji-feedback" id="emojiF">'+emojis[val]+'</div>';
h+='</div>';
}

if(step.type==='text'){
var val=answers[step.id]||'';
h+='<textarea class="text-input" id="textInput" placeholder="'+(step.ph||'')+'" oninput="answers[\''+step.id+'\']=this.value">'+val+'</textarea>';
}

if(step.type==='chooseFlavor'){
h+='<div class="flavor-card'+(firstFlavor==='coco'?' selected':'')+'" onclick="chooseFlavor(\'coco\')">';
h+='<div class="flavor-icon">ğŸ¥¥</div>';
h+='<div class="choice-content"><div class="choice-label">Coco & Chocolate Branco</div><div class="choice-description">Tropical e suave</div></div></div>';
h+='<div class="flavor-card'+(firstFlavor==='frutos'?' selected':'')+'" onclick="chooseFlavor(\'frutos\')">';
h+='<div class="flavor-icon">ğŸ«</div>';
h+='<div class="choice-content"><div class="choice-label">Frutos Vermelhos & Chocolate Negro</div><div class="choice-description">Intenso e frutado</div></div></div>';
}

if(step.type==='compare'){
h+='<div class="comparison-row">';
if(firstFlavor){
[firstFlavor,sf()].forEach(function(fid){
var f=FLAVORS[fid];
var sel=answers.preferida===fid?' selected':'';
h+='<div class="comparison-card'+sel+'" onclick="selectSingle(\'preferida\',\''+fid+'\')">';
h+='<div class="comparison-emoji">'+f.emoji+'</div>';
h+='<div class="comparison-label">'+f.short+'</div></div>';
});
}
h+='</div>';
var sel3=answers.preferida==='ambas'?' selected':'';
h+='<div class="choice-option'+sel3+'" onclick="selectSingle(\'preferida\',\'ambas\')" style="margin-bottom:24px">';
h+='<span class="choice-icon">ğŸ¤</span><div class="choice-content"><div class="choice-label">Gostei das duas por igual</div></div><div class="choice-check"></div></div>';
}

if(step.type==='info'){
h+='<div style="margin-bottom:24px"><span class="badge">RevelaÃ§Ã£o</span></div>';
h+='<h2 class="question-title">O que hÃ¡ dentro destas barras?</h2>';
h+='<p class="question-subtitle">Cada barra de 35g contÃ©m 3g de creatina monohidratada.</p>';
h+='<div class="creatine-box"><h3>âš¡ Creatina â€” 3g por barra</h3>';
h+='<p>Dose diÃ¡ria cientificamente validada para resultados reais.</p>';
h+='<ul class="creatine-list">';
h+='<li>Aumenta a forÃ§a e performance muscular</li>';
h+='<li>Melhora a recuperaÃ§Ã£o pÃ³s-treino</li>';
h+='<li>BenefÃ­cios cognitivos: memÃ³ria e foco</li>';
h+='<li>Aprovada pelo ComitÃ© OlÃ­mpico Internacional</li>';
h+='</ul>';
h+='<p class="science-ref" style="opacity:.5;margin-top:12px;font-size:11px">Harvard Health 2024 Â· PMC Systematic Review 2021 Â· Frontiers in Nutrition 2024</p>';
h+='</div>';
h+='<div class="tabs"><button class="tab-btn'+(infoTab==='coco'?' active':'')+'" onclick="switchInfoTab(\'coco\')">ğŸ¥¥ Coco & Choc. Branco</button><button class="tab-btn'+(infoTab==='frutos'?' active':'')+'" onclick="switchInfoTab(\'frutos\')">ğŸ« Frutos Verm. & Choc. Negro</button></div>';
h+='<div class="info-card" id="nutritionCard">'+renderNutritionTable(infoTab)+'</div>';
}

// Nav buttons
var needsNav=step.type!=='welcome'&&step.type!=='transition'&&step.type!=='thanks';
if(needsNav){
var isFirst=currentStep===1;
var needsNext=step.type==='text'||step.type==='multi'||step.type==='info'||step.type==='slider';
var hasAnswer=!!answers[step.id];
if(step.type==='multi')hasAnswer=(answers[step.id]||[]).length>0;
if(step.type==='slider')hasAnswer=true;
if(step.type==='info')hasAnswer=true;
if(step.type==='chooseFlavor')hasAnswer=!!firstFlavor;

h+='<div class="nav-buttons">';
if(!isFirst)h+='<button class="btn btn-back" onclick="goBack()">â†</button>';
if(needsNext){
var dis=!hasAnswer&&!step.opt?' disabled':'';
h+='<button class="btn btn-primary" id="nextBtn"'+dis+' onclick="goNext()">Seguinte â†’</button>';
} else if(step.type==='chooseFlavor'){
h+='<button class="btn btn-primary"'+(firstFlavor?'':' disabled')+' onclick="goNext()">Seguinte â†’</button>';
}
h+='</div>';

if(step.opt){
h+='<button class="skip-link" onclick="goNext()">Saltar â†’</button>';
}
}

h+='</div>';
container.innerHTML=h;
window.scrollTo(0,0);
}

function selectSingle(id,v){
answers[id]=v;
var steps=buildSteps();
var step=steps[currentStep];
if(step&&step.type!=='compare'){
setTimeout(function(){goNext();},250);
} else {
render();
}
}

function toggleMulti(id,v){
if(!answers[id])answers[id]=[];
var idx=answers[id].indexOf(v);
if(idx>-1)answers[id].splice(idx,1);
else answers[id].push(v);
render();
}

function updateSlider(id){
var s=document.getElementById('sliderInput');
var v=parseInt(s.value);
answers[id]=v;
var emojis=['','ğŸ˜«','ğŸ˜•','ğŸ˜','ğŸ™‚','ğŸ˜„'];
document.getElementById('emojiF').textContent=emojis[v];
document.querySelectorAll('.scale-point').forEach(function(p){
p.classList.toggle('active',parseInt(p.textContent)===v);
});
}

function setSlider(id,v){
answers[id]=v;
document.getElementById('sliderInput').value=v;
updateSlider(id);
}

function chooseFlavor(fid){
firstFlavor=fid;
render();
}

function switchInfoTab(t){
infoTab=t;
document.querySelectorAll('.tab-btn').forEach(function(b){b.classList.remove('active');});
event.target.classList.add('active');
document.getElementById('nutritionCard').innerHTML=renderNutritionTable(t);
}

function goNext(){
var steps=buildSteps();
// Save text input
var ti=document.getElementById('textInput');
if(ti){var step=steps[currentStep];if(step)answers[step.id]=ti.value;}
// Save slider
var si=document.getElementById('sliderInput');
if(si){var step=steps[currentStep];if(step)answers[step.id]=parseInt(si.value);}

currentStep++;
var newSteps=buildSteps();
if(currentStep>=newSteps.length)currentStep=newSteps.length-1;
render();
}

function goBack(){
if(currentStep>0){
currentStep--;
var steps=buildSteps();
if(currentStep>=steps.length)currentStep=steps.length-1;
render();
}
}

var basinSent=false;
function submitToBasin(){
if(basinSent)return;
basinSent=true;
var data={
timestamp:new Date().toISOString(),
exercicio:answers.exercicio||'',
tipo_exercicio:(answers.tipoExercicio||[]).join(', '),
suplementos:answers.suplementos||'',
creatina:answers.creatina||'',
conhece_creatina:answers.conheceCr||'',
barras_proteicas:answers.barras||''
};
['coco','frutos'].forEach(function(fid){
var pre=fid+'_';
data[pre+'aspeto']=answers[fid+'_aspeto']||'';
data[pre+'aroma']=answers[fid+'_aroma']||'';
data[pre+'sabor']=answers[fid+'_sabor']||'';
data[pre+'residual']=answers[fid+'_residual']||'';
data[pre+'residual_desc']=answers[fid+'_residualDesc']||'';
data[pre+'docura']=answers[fid+'_docura']||'';
data[pre+'textura']=answers[fid+'_textura']||'';
data[pre+'mastigar']=answers[fid+'_mastigar']||'';
data[pre+'compraria']=answers[fid+'_compraria']||'';
data[pre+'sugestoes']=answers[fid+'_sugestoes']||'';
});
data.primeira_barra=firstFlavor||'';
data.preferida=answers.preferida||'';
data.pref_motivo=answers.prefMotivo||'';
data.ocasiao=(answers.ocasiao||[]).join(', ');
data.expectativa=answers.expectativa||'';
data.surpresa_positiva=answers.surpresaPos||'';
data.surpresa_negativa=answers.surpresaNeg||'';
data.intencao_pos_info=answers.intencaoPos||'';
data.praticidade=answers.praticidade||'';
data.preco_justo=answers.preco||'';
data.confianca_ingredientes=answers.confianca||'';
data.comentario_final=answers.comentarioFinal||'';
console.log('ğŸ“¤ Basin:',data);
fetch(BASIN_URL,{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify(data)})
.then(function(r){console.log(r.ok?'âœ… OK':'âŒ Erro:'+r.status);showThanks(r.ok);})
.catch(function(e){console.error('âŒ',e);showThanks(false);});
}
function showThanks(ok){
document.getElementById('thanksIcon').textContent='âœ…';
document.getElementById('thanksTitle').textContent='Obrigado!';
document.getElementById('thanksSub').innerHTML='A tua opiniÃ£o Ã© essencial para criarmos produtos que fazem sentido.<br><br>â€” Guilherme & Sara, CORIAL'+(ok?'':'<br><br><small style="opacity:.5">âš ï¸ Erro ao enviar â€” respostas registadas localmente.</small>');
}

render();
</script>
</body>
</html>
